require(lme4)
str(Dyestuff)
library(lattice)
plot(Dyestuff)
xyplot(Yield~Batch,Dyestuff)

print(dotplot(reorder(Batch, Yield) ~ Yield, Dyestuff,
              ylab = "Batch", jitter.y = TRUE, pch = 21,
              xlab = "Yield of dyestuff (grams of standard color)",
              type = c("p", "a")))

fm01 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff)
fm01

## Notice that the variability between Batch-es in the Random
## effects...

#Random effects:
 #   Groups   Name        Std.Dev.
#Batch    (Intercept) 42.00   
#Residual             49.51 

## ...is not the same as the sd of the means in Yield for each
## Batch:

ave_yields <- vector()
for(i in levels(Dyestuff[,1])){
    ave_yields[i] <- mean(Dyestuff[Dyestuff$Batch==i,'Yield'])
}
str(ave_yields)
sd(ave_yields)
